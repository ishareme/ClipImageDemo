!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ClipImage=e()}(this,function(){"use strict";function t(t){var e={},i=e.toString.call(t);return null==t?t+"":("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(t){e["[object "+t+"]"]=t.toLowerCase()}),"object"===(void 0===t?"undefined":n(t))||"function"==typeof t?e[i]||"object":void 0===t?"undefined":n(t))}function e(t){var e=void 0,i=void 0,n={},o=n.toString,r=n.hasOwnProperty,s=r.toString,u=s.call(Object);return!(!t||"[object Object]"!==o.call(t))&&(!(e=Object.getPrototypeOf(t))||"function"==typeof(i=r.call(e,"constructor")&&e.constructor)&&s.call(i)===u)}function i(){for(var t=this,e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return console.log("ImageClip"),new Promise(function(e,n){t.init(i,e,n)})}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o={isImageDom:function(t){return"img"===t.tagName.toLowerCase()},isCanvasDom:function(t){return"canvas"===t.tagName.toLowerCase()},isVideoDom:function(t){return"video"===t.tagName.toLowerCase()},isPX:function(t){return t.trim().endsWith("px")},isPercent:function(t){return t.trim().endsWith("%")},isCenter:function(t){return"center"===t.trim().toLowerCase()},isLeft:function(t){return"left"===t.trim().toLowerCase()},isTop:function(t){return"top"===t.trim().toLowerCase()},isRight:function(t){return"right"===t.trim().toLowerCase()},isBottom:function(t){return"bottom"===t.trim().toLowerCase()},isPNG:function(t){return"png"===t.trim().toLowerCase()},isJPG:function(t){return"jpg"===t.trim().toLowerCase()||"jpeg"===t.trim().toLowerCase()},isArray:Array.isArray||function(t){return"[object Array]"===Array.prototype.toString.call(t)},isNumber:function(t){return"number"==typeof t&&isFinite(t)},isString:function(t){return"string"==typeof t},isBoolean:function(t){return"boolean"==typeof t},isFun:function(t){return"function"==typeof t},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return"number"==typeof t&&isNaN(t)}),$:function(t){return document.querySelector?document.querySelector(t):t.indexOf("#")>-1?document.getElementById(t.replace("#","")):t.indexOf(".")>-1?document.getElementsByClassName(t.replace(".",""))[0]:document.getElementsByTagName(t)[0]},extend:function(){var i=void 0,o=void 0,r=void 0,s=void 0,u=void 0,c=void 0,a=arguments[0]||{},f=1,l=arguments.length,g=!1;for("boolean"==typeof a&&(g=a,a=arguments[f]||{},f++),"object"!==(void 0===a?"undefined":n(a))&&"function"!==t(a)&&(a={}),f===l&&(a=this,f--);f<l;f++)if(null!==(i=arguments[f]))for(o in i)u=a[o],s=i[o],a!=s&&(g&&s&&(e(s)||(c=Array.isArray(s)))?(c?(c=!1,r=u&&Array.isArray(u)?u:[]):r=u&&e(u)?u:{},a[o]=this.extend(g,r,s)):void 0!==s&&(a[o]=s));return a}};return i.prototype={init:function(t,e,i){return console.log("options",t),this.defaultConfigOption={width:100,height:100,left:0,top:0,type:"jpeg",quality:1,success:function(){},error:function(){}},this.errorObj={},!o.isUndefined(t[0])&&(o.isString(t[0])||o.isImageDom(t[0])||o.isCanvasDom(t[0])||o.isVideoDom(t[0]))?o.isObject(t[1])?(this.canvasImageSource=t[0],this.configOptions=o.extend(!0,this.defaultConfigOption,t[1]),void this.initCanvas(this.canvasImageSource,e,i)):new Error("ClipImage第二个参数是对象哦~~"):new Error("ClipImage第一个参数是url/HTMLImageElement/HTMLVideoElement/HTMLCanvasElement")},initCanvas:function(t,e,i){var n=this;this.resultCanvas=document.createElement("canvas"),this.resultCtx=this.resultCanvas.getContext("2d"),this.resultW=this.getRealVal(this.configOptions.width,"x"),this.resultH=this.getRealVal(this.configOptions.height,"y"),this.sourceX=this.getRealVal(this.configOptions.left,"x"),this.sourceY=this.getRealVal(this.configOptions.top,"y"),this.resultCanvas.width=this.resultW,this.resultCanvas.height=this.resultH,o.isString(t)||o.isImageDom(t)?(this.sourceImage=new Image,this.sourceImage.setAttribute("crossOrigin","anonymous"),this.sourceImage.onload=function(){n.clip(e)},this.sourceImage.onerror=function(t){n.configOptions.error&&n.configOptions.error(t),i(t)},this.sourceImage.src=o.isImageDom(t)?t.src:t):o.isCanvasDom(t)?(this.sourceImage=t,this.clip(e)):o.isVideoDom(t)},clip:function(t){console.log("source",this.sourceImage),this.resultCtx.drawImage(this.sourceImage,this.sourceX,this.sourceY,this.resultW,this.resultH,0,0,this.resultW,this.resultH),this.resultB64=this.resultCanvas.toDataURL("image/"+this.getOutType(this.configOptions.type),this.configOptions.quality),this.configOptions.success&&this.configOptions.success(this.resultB64),t(this.resultB64)},getRealVal:function(t,e){return o.isNumber(t)||o.isString(t)&&o.isPX(t)?o.isNumber(t)?t:parseInt(t.trim().slice(0,-2)):o.isString(t)&&o.isPercent(t)?"x"===e?this.sourceImage.width*(parseInt(t.slice(0,-1))/100):this.sourceImage.height*(parseInt(t.slice(0,-1))/100):o.isString(t)&&o.isCenter(t)?"x"===e?this.sourceImage.width/2:this.sourceImage.height/2:o.isString(t)&&(o.isLeft(t)||o.isTop(t))?0:o.isString(t)&&(o.isRight(t)||o.isBottom(t))?o.isRight(t)?this.sourceImage.width:this.sourceImage.height:(this.errorObj.msg="参数配置错误",this.configOptions.error&&this.configOptions.error(this.errorObj),!1)},getOutType:function(t){return o.isJPG(t)?"jpeg":"png"}},i});
//# sourceMappingURL=ClipImage.min.js.map
